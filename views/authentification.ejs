<!DOCTYPE html>
<html lang="en">
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/authentification.css' />
    <link rel="icon" href="/icons/48x48.png" type="image/png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Mon PWA">
    <link rel="apple-touch-icon" href="/icons/192x192.png">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
   
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
     <nav>
	<div style="background: url(/icons/bk.jpeg) no-repeat"></div>
	<h3>Bookup</h3>
     </nav>
     <center>
     	<form>
     		<h3>SIGN UP</h3>
     		<label>Username</label>
     		<span>
     			<input type="text" required placeholder="your username">
     			<i class='bx bxs-user' ></i>   
     		</span>
     		<label>Phone</label>
     		<span>
     			<input type="text" required placeholder="+237 xxxx xxxx">
     			<i class='bx bxs-phone' ></i>   
     		</span>
     		<label>Password</label>
     		<span>
     			<input type="password" required id="passwordInput" placeholder="enter password">
     			<i class='bx bxs-low-vision' id="togglePassword"></i>   
     		</span>
     		<label>Confirm password</label>
     		<span>
     			<input type="password" required id="passwordInput2" placeholder="repeat password">
     			<i class='bx bxs-low-vision'  id="togglePassword2"></i>   
     		</span>
     		
     		<center>
     			<div class="custom-select" style="width:150px;">
			  <select>
			    <option value="0">Ville:</option>
			    <option value="yde">Yaoundé</option>
			    <option value="dla">Douala</option>
			  </select>
			</div></br>
			<div class="custom-select" style="width:150px;">
			  <select>
			    <option value="0">Quartier:</option>
			    <option value="1">Yaounde</option>
			    <option value="2">Douala</option>
			    <option value="2">Douala</option>
			    <option value="2">Douala</option>
			    <option value="2">Douala</option>
			    <option value="2">Douala</option>
			    <option value="2">Douala</option>
			    <option value="2">Douala</option>
			    <option value="2">Douala</option>
			  </select>
			</div></br>
     			<input type="submit" value="create account"> 
     		</center>
  		
     	</form>
     </center>
 </body>
 <script>
    
    document.addEventListener('DOMContentLoaded', function() {
    const togglePassword = document.getElementById('togglePassword');
    const passwordInput = document.getElementById('passwordInput');
    const togglePassword2 = document.getElementById('togglePassword2');
    const passwordInput2 = document.getElementById('passwordInput2');
    
    togglePassword.addEventListener('click', function() {
        // Basculer entre password et text
        const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordInput.setAttribute('type', type);
        
        // Changer l'icône
        if (type === 'text') {
            // Mot de passe visible - œil normal
            togglePassword.classList.remove('bxs-low-vision');
            togglePassword.classList.add('bx-show'); // Icône œil ouvert
        } else {
            // Mot de passe masqué - œil barré
            togglePassword.classList.remove('bx-show');
            togglePassword.classList.add('bxs-low-vision');
        }
    });
    togglePassword2.addEventListener('click', function() {
        // Basculer entre password et text
        const type = passwordInput2.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordInput2.setAttribute('type', type);
        
        // Changer l'icône
        if (type === 'text') {
            // Mot de passe visible - œil normal
            togglePassword2.classList.remove('bxs-low-vision');
            togglePassword2.classList.add('bx-show'); // Icône œil ouvert
        } else {
            // Mot de passe masqué - œil barré
            togglePassword2.classList.remove('bx-show');
            togglePassword2.classList.add('bxs-low-vision');
        }
    });
});
var x, i, j, l, ll, selElmnt, a, b, c;
x = document.getElementsByClassName("custom-select");
l = x.length;
for (i = 0; i < l; i++) {
  selElmnt = x[i].getElementsByTagName("select")[0];
  ll = selElmnt.length;
  a = document.createElement("DIV");
  a.setAttribute("class", "select-selected");
  a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
  x[i].appendChild(a);
  b = document.createElement("DIV");
  b.setAttribute("class", "select-items select-hide");
  for (j = 1; j < ll; j++) {
    c = document.createElement("DIV");
    c.innerHTML = selElmnt.options[j].innerHTML;
    
    // Stocker les valeurs dans les attributs data- de l'élément
    c.setAttribute('data-value', selElmnt.options[j].value);
    c.setAttribute('data-text', selElmnt.options[j].innerHTML);
    
    c.addEventListener("click", function(e) {
        // Récupérer les valeurs depuis les attributs data-
        var selectedValue = this.getAttribute('data-value');
        var selectedText = this.getAttribute('data-text');
        
        // Afficher dans la console
       // console.log("Option choisie:", selectedValue, "-", selectedText);
       fetchData(selectedText);
        
        var y, i, k, s, h, sl, yl;
        s = this.parentNode.parentNode.getElementsByTagName("select")[0];
        sl = s.length;
        h = this.parentNode.previousSibling;
        for (i = 0; i < sl; i++) {
          if (s.options[i].innerHTML == this.innerHTML) {
            s.selectedIndex = i;
            h.innerHTML = this.innerHTML;
            y = this.parentNode.getElementsByClassName("same-as-selected");
            yl = y.length;
            for (k = 0; k < yl; k++) {
              y[k].removeAttribute("class");
            }
            this.setAttribute("class", "same-as-selected");
            
            // Appeler une fonction personnalisée si nécessaire
            //onOptionSelected(selectedValue, selectedText);
            
            break;
          }
        }
        h.click();
    });
    b.appendChild(c);
  }
  x[i].appendChild(b);
  a.addEventListener("click", function(e) {
    e.stopPropagation();
    closeAllSelect(this);
    this.nextSibling.classList.toggle("select-hide");
    this.classList.toggle("select-arrow-active");
  });
}

function closeAllSelect(elmnt) {
  var x, y, i, xl, yl, arrNo = [];
  x = document.getElementsByClassName("select-items");
  y = document.getElementsByClassName("select-selected");
  xl = x.length;
  yl = y.length;
  for (i = 0; i < yl; i++) {
    if (elmnt == y[i]) {
      arrNo.push(i)
    } else {
      y[i].classList.remove("select-arrow-active");
    }
  }
  for (i = 0; i < xl; i++) {
    if (arrNo.indexOf(i)) {
      x[i].classList.add("select-hide");
    }
  }
}
document.addEventListener("click", closeAllSelect);

// Fonction pour gérer la sélection d'option
function onOptionSelected(value, text) {
  console.log("✅ Ville sélectionnée : " + text + " (valeur : " + value + ")");
}
async function fetchData(town) {
  try {
    const response = await fetch(`http://192.168.43.87:3000/Authentification/${town}`);
    const data = await response.json();
    console.log(data);
  } catch (error) {
    console.error('Error:', error);
  }
}
 </script>
</html>

